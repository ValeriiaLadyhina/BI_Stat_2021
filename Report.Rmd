---
title: "Project 1 Analysis of Data on Olympic Games 1896 - 2016"
author: "Valeriia Ladyhina"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: lumen
---

```{css my-header-colors, echo = FALSE}
.page-header {
    background-image: linear-gradient(180deg, MidnightBlue , Cyan );
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(tidyr)
setwd('../data')
```

---
*The project is a part of course in Statistics from Bioinformatic Institute. In this project I performed analysis of the data of Olympic Games that took place in years from 1896 till 2016.*
---

<p style="font-family: times, serif; font-size:18pt; font-style:bold; color:black"> __Data collection__ </p>

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> To merge all files into one data frame you can use next function. </p>

```{r warning=FALSE}
merge_csv_files_in_one_dataframe<-function(){
  do.call(rbind,lapply(setdiff(list.files(pattern = '.csv'),
                               list.files(pattern="combined_")), read.csv))}
```

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Merging files into one data frame named athlete_events_combined. </p>

```{r warning=FALSE}
athlete_events_combined<-merge_csv_files_in_one_dataframe()
```

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Saving created data frame into combined_athlete_events.csv </p>

```{r}
write.csv(athlete_events_combined,'combined_athlete_events.csv')
```

<p style="font-family: times, serif; font-size:18pt; font-style:bold; color:black"> __EDA__ </p>

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:Midnightblue"> Check structure of the data to find out if types of parameters match the expected. </p>

```{r eval=FALSE}
str(athlete_events_combined)
```

<p style="font-family: times, serif; font-size:12pt; font-style:italic; color:MidnightBlue"> Table 1 Structure of the collected data </p>

```{r echo=FALSE}
data.frame(variable = names(athlete_events_combined),
           length = sapply(athlete_events_combined, length),
           first_values = sapply(athlete_events_combined, function(x) paste0(head(x),  collapse = ", ")),
           row.names = NULL) %>% 
  kable() %>% 
  kable_styling(full_width = F, "striped", font_size = 10) %>% 
  column_spec(1, bold = T, color = 'black')

```

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> We will change some of the variables' types: ***Sex***, ***NOC***, ***Team***, ***Season*** on factor. </p>

```{r}
athlete_events_combined$Sex<-factor(athlete_events_combined$Sex,levels = c('F','M'))
athlete_events_combined$NOC<-factor(athlete_events_combined$NOC)
athlete_events_combined$Team<-factor(athlete_events_combined$Team)
athlete_events_combined$Season<-factor(athlete_events_combined$Season)
```

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Summary of the data to check weird outliers. </p>

```{r}
summary(athlete_events_combined)
```

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Variable **Height** has strange outliers: **127, 340**, therefore I will check if this data reflects the reality. Firstly I will visualise data. </p>

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> **Figure 1.** Visualisation of **Height** distribution. </p>

```{r message=FALSE,echo = FALSE,warning=FALSE, figures-side, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
ggplot(athlete_events_combined,aes(Height))+
  geom_boxplot()+
  theme_bw()
ggplot(athlete_events_combined,aes(Height))+
  geom_density()+
  theme_bw()
```

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Based on plots it is visible that distribution of height among athlets is normal except one outlier with height 340. I will check the name and real height of this sportmen to fix it. </p>

```{r}
athlete_events_combined$Name[which(athlete_events_combined$Height == 340)]
athlete_events_combined$Height[which(athlete_events_combined$Height == 340)] = 176
```

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> The highest sportsmen is Kirsty Leigh Coventry, her real height is 176, so this variable was fixed to the real number. </p>

+   <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> The same kind of analysis I will perform on variables **Age** and **Weight**. </p>
+ <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Analysis of __Age__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> **Figure 2.** Visualization of **Age** distribution. </p>

```{r message=FALSE,echo=FALSE,warning=FALSE,  fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
ggplot(athlete_events_combined,aes(Age))+
  geom_boxplot()+
  theme_bw()
ggplot(athlete_events_combined,aes(Age))+
  geom_density()+
  theme_bw()
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Plots show that there is an outlier with age ~250 years. </p>

+  <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Top 10 variables in ***Age*** </p>


```{r}
head(unique(sort(athlete_events_combined$Age, decreasing = TRUE)), n = 10)
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> I will check two eldest sportsmen with age 240 and 97 respectively. </p>
```{r}
athlete_events_combined$Name[which((athlete_events_combined$Age ==240))]
athlete_events_combined$Year[which((athlete_events_combined$Age ==240))]
athlete_events_combined$Age[which((athlete_events_combined$Age ==240))] = 24
athlete_events_combined$Name[which((athlete_events_combined$Age ==97))]
athlete_events_combined$Year[which((athlete_events_combined$Age ==97))]
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> There was a typo: Flicien Jules mile Courbet was 24 years during Olympic Games 1912. </p>
+ <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> 10 smallest variables in ***Age*** </p>

```{r}
head(unique(sort(athlete_events_combined$Age)), n = 10)
athlete_events_combined$Name[which((athlete_events_combined$Age ==10))]
head(athlete_events_combined$Name[which((athlete_events_combined$Age ==11))], n = 3)
```

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue">  The first three youngest sportsmen were checked for the correctness of their age and data reflects reality. </p>

+ <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Analysis of __Weight__ </p> 
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> **Figure 3.** Visualization of **Weight** distribution. </p>

```{r message=FALSE, warning=FALSE,  fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
ggplot(athlete_events_combined,aes(Weight))+
  geom_boxplot()+
  theme_bw()
ggplot(athlete_events_combined,aes(Weight))+
  geom_density()+
  theme_bw()
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> From the plot it is visible that there is an outlier whose wait is ~ 10, the upper numbers of weight do not look extreme. So I will check the correctness of the weight of the lightest sportsman. </p>
-   Smallest 10 variables in ***Weight***

```{r}
head(unique(sort(athlete_events_combined$Weight)), n = 10)
athlete_events_combined$Name[which(athlete_events_combined$Weight == 7)]
athlete_events_combined$Weight[which(athlete_events_combined$Weight == 7)] = 77
```

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> There was a typo in weight of the lightest sportsman and it was fixed.</p>

+ <p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> In case there are rows that fully consist from NA I will remove them. </p>

```{r}
athlete_events_combined <- athlete_events_combined[!(grepl('NA',rownames(athlete_events_combined))),]
```

<p style="font-family: times, serif; font-size:18pt; font-style:bold; color:black"> __Tasks__ </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Age of the youngest sportsmen among both genders on Olympic games 1992.__* </p>

```{r eval=FALSE}
athlete_events_combined %>% 
                filter(Year == 1992) %>% 
                group_by(Sex) %>%
                summarise(min(Age,na.rm = TRUE)) %>% 
                kable(col.names = c('Gender','Minimal Age')) %>% 
                kable_styling(full_width = F, "striped", font_size = 10) %>% 
                column_spec(1, bold = T, color = 'black')

```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Table 2__ Age of the youngest sportsmen in year 1992 </p>
```{r echo=FALSE}
athlete_events_combined %>% 
                filter(Year == 1992) %>% 
                group_by(Sex) %>%
                summarise(min(Age,na.rm = TRUE)) %>% 
                kable(col.names = c('Gender','Minimal Age')) %>% 
                kable_styling(full_width = F, "striped", font_size = 10) %>% 
                column_spec(1, bold = T, color = 'black')

```
<p style="font-family: times, serif; font-size:16pt; font-style:bold; color:black"> *__Mean and standard deviation of Height among women and men.__*  </p>
```{r}
statistics_height<- athlete_events_combined %>% 
                    group_by(Sex) %>% 
                    summarise(Mean = mean(Height,na.rm = TRUE), SD = sd(Height,na.rm = TRUE)) %>% 
                    na.omit()
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Table 3__ Average height and standard deviation among women and men who participated in Olympic games in years 1896 - 2016. </p>
```{r echo=FALSE}
kable(statistics_height, col.names = c('Gender','Mean','SD')) %>% 
kable_styling(full_width = F, "striped", font_size = 10) %>% 
                column_spec(1, bold = T, color = 'black')
```

<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Average and standard deviation of Height among women who participated in tennis competion of 2000.__* </p>

```{r}
women_tennis_height_statistics<-athlete_events_combined %>% 
  filter(Sport == 'Tennis', Sex == 'F', Year == 2000) %>% 
  summarise(Mean = mean(Height,na.rm = TRUE),SD = sd(Height,na.rm = TRUE))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Table 4__ Average height and standard deviation among women who participated in Tennis competition in 2000. </p>
```{r echo=FALSE}
kable(women_tennis_height_statistics) %>% 
kable_styling(full_width = F, "striped", font_size = 10) %>% 
                column_spec(1, bold = T, color = 'black')
```

<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Type of sport of the heaviest sportsman in Athletics 2006__*  </p>
```{r}
sport_of_heaviest_sportman<-athlete_events_combined %>% 
filter(Year == 2006) %>% 
slice(which.max(Weight))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue">`r sport_of_heaviest_sportman$Name` is the heaviest athlete of year 2006 with weight `r sport_of_heaviest_sportman$Weight` kg, who participated in __`r sport_of_heaviest_sportman$Sport` 
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Number of Golden medals that has been aken by women in Years 1980-2010__* </p>
```{r}
number_of_gold_women_80_10<-nrow(athlete_events_combined %>% 
filter(Year<=2010, Year>=1980, Sex =="F", Medal == "Gold"))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> In years from 1980 to 2010 women obtained `r number_of_gold_women_80_10` of Gold medals. </p>

<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Participation of John Aalberg in Olympic Games__* </p>
```{r}
times_John<-length(unique((athlete_events_combined %>% 
  filter(Name == 'John Aalberg'))$Year))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> John Aalberg participated in Olympic Games `r times_John` times. </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Age groups of sportsmen in Olympic Games 2008__* </p>
```{r}
table<-table(cut((athlete_events_combined[athlete_events_combined$Year == 2008,]$Age),seq(15,55,10), include.lowest = TRUE, right = FALSE))
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Table 4__ Age groups presented in Olympic Games 2008. </p>
```{r}
kable(table, col.names = c('Age group','Number of participants'))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Based on table 4 the conclusion is that the most abundant age group of sportsmen in 2008 is group of age from 25 to 34. </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Comparison of sport variety between years 1994 and 2002__* </p>
```{r}
difference_number_of_sports_2002_1994<-length(unique((athlete_events_combined %>%                                         filter(Year==2002))$Sport))-length(unique((athlete_events_combined %>% 
                                        filter(Year==1994))$Sport))
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> In year 2002 the range of presented types of sport was wider on `r difference_number_of_sports_2002_1994` than in year 1994.</p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Countries with most gold, silver and bronze medals during winter and summer seasons__* </p>

```{r warning=FALSE, error=FALSE, message=FALSE}
winter_summer_medals_abundance<-athlete_events_combined %>% 
  filter(Medal!='',Medal!='NA') %>% 
  group_by(Season,Medal,NOC)%>% 
  summarise(n = n()) %>% 
  slice_max(order_by = n, n = 3)
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Answer__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Table 5__  Top three countries in number of gold, silver, bronze medals during winter and summer seasons.   </p>
```{r echo=FALSE}
kable(winter_summer_medals_abundance) %>% 
kable_styling(full_width = F, "striped", font_size = 10) %>% 
                column_spec(1, bold = T, color = 'black') %>% 
                row_spec(1:3,background = 'LightYellow') %>% 
                row_spec(4:6,background = 'Gold') %>% 
                row_spec(7:9,background = 'Yellow') %>% 
                row_spec(10:12,background = 'Azure') %>% 
                row_spec(13:15,background = 'SkyBlue') %>% 
                row_spec(16:18,background = 'PowderBlue')
                
```
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Z-scaling for variable Height__* </p>
```{r}
Height_z_scores<-scale(athlete_events_combined$Height)
```
<p style="font-family: times, serif; font-size:18pt; font-style:bold; color:black"> __Editional Tasks__ </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Min-max-scaling for variable Height__* </p>
```{r, eval=FALSE}
min_max_scale <- function(x) {
  (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
}
Height_min_max_scaled<-(athlete_events_combined %>% 
  mutate(Height_min_max_scaled = min_max_scale(Height)))$Height
```
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> *__Comparison of height, weight, age of men and women who participated in winter season games.__* </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> __Figure 4__ Check for normality of distribution of __Height__ </p>
```{r  echo=FALSE,warning=FALSE, fig.show="hold", out.width="50%"}
qqnorm(athlete_events_combined$Height)
qqline(athlete_events_combined$Height)
ggplot(athlete_events_combined,aes(Height))+
  geom_density()+
  theme_bw()
```
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> __Figure 5__ Check for normality of distribution of __Weight__ </p>
```{r  echo=FALSE, warning=FALSE, fig.show="hold", out.width="50%"}
qqnorm(athlete_events_combined$Weight)
qqline(athlete_events_combined$Weight)
ggplot(athlete_events_combined,aes(Weight))+
  geom_density()+
  theme_bw()
```
<p style="font-family: times, serif; font-size:16pt; font-style:italics; color:black"> __Figure 6__ Check for normality of distribution of __Age__ </p>
```{r  warning=FALSE, echo=FALSE,fig.show="hold", out.width="50%"}
qqnorm(athlete_events_combined$Age)
qqline(athlete_events_combined$Age)
ggplot(athlete_events_combined,aes(Age))+
  geom_density()+
  theme_bw()
```
```{r warning=FALSE, fig.show="hold", out.width="50%"}
height_data<-select(athlete_events_combined,c(Sex,Height))
height_data$Sex<-factor(height_data$Sex, levels = c('F','M'))
height_data<- drop_na(height_data) 
#group_size
length(height_data)

#t-test Height
t.test(Height~Sex, data = height_data)
```
```{r warning=FALSE, fig.show="hold", out.width="50%"}
weight_data<-select(athlete_events_combined,c(Sex,Weight))
weight_data$Sex<-factor(weight_data$Sex, levels = c('F','M'))
weight_data<- drop_na(weight_data)
#group_size
length(weight_data)


#wilcox-test weight
wilcox.test(Weight~Sex, data = weight_data)
```
```{r warning=FALSE, fig.show="hold", out.width="50%"}
age_data<-select(athlete_events_combined,c(Sex,Age))
age_data$Sex<-factor(age_data$Sex, levels = c('F','M'))
age_data<- drop_na(age_data)
#group_size
length(age_data)
 
#wilcox-test age
wilcox.test(Age~Sex, data = age_data)
```  
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Figure 7__ Comparison of height, weight and age inbetween female and male athletes.  </p>
```{r warning=FALSE, fig.show="hold", out.width="50%"}
ggplot(height_data,aes(Sex,Height, color = Sex))+
  geom_violin()+ 
  stat_summary(fun.data="mean_sdl", 
                              geom="crossbar", width=0.1 )+
  ggtitle('Height\nwomen vs men',)+
  theme_bw()
ggplot(weight_data,aes(Sex,Weight, color = Sex))+
  geom_violin()+ 
  stat_summary(fun.data="mean_sdl", 
                 geom="crossbar", width=0.075 )+
  ggtitle('Weight\nwomen vs men',)+
  theme_bw()
    ggplot(age_data,aes(Sex,Age, color = Sex))+
    geom_violin()+ 
    stat_summary(fun.data="mean_sdl", 
                 geom="crossbar", width=0.05 )+
    ggtitle('Age\nwomen vs men',)+
    theme_bw()
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Conclusion__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> To perform analysis on height, weight and age of sportsmen depanding on there gender I checked normality of distribution of variables of interest based on QQ plot and density plot. Figure 4 showed that height distributed normally therefore to check H0 (There is no difference between height of men and women) I performed t-test. As p-value < 2.2e-16, the difference is significant, height of men is higher than of women. QQ plot of weight and age (Figure5,6) are skewed therefore for further analysis I performed non-parametric test Mann-Whitney. For both variables of interest the result showed p-value < 2.2e-16, therefore differences (weight of women lower than weight of men, the same as age) are significant. Visualisation of distribution of height,weight and age in depandancy with gender is shown on Figure 7. </p>
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:black "> __Correlation between Team and Medal__ </p>

```{r}
result_team_medal<- athlete_events_combined %>% 
  group_by(Year, NOC) %>% 
  na.omit() %>% 
  filter(Medal!="", Year >=2000, Season == "Summer") %>% 
  summarise(Count = n()) %>% 
  arrange(-Count)

result_team_medal<- result_team_medal %>% 
  filter(Count>=20) 
```
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Figure 8__ Number of gold, silver and bronze medals per country</p>
```{r warning=FALSE, echo = FALSE, fig.show="hold", out.width="80%", fig.align='center'}
ggplot(result_team_medal,aes(NOC, Count, color = NOC))+
  geom_point(dotsize = 0.5)+
  facet_grid(col = vars(Year))+
  theme_bw()
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Conclusion__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> To analyze if there any dependency between NOC and Medals I visualized number of obtained medals during the period from 2000 to 2016 only for summer season. Such choice of time line is based idea that in earlier years not so many teams were involved into Olympic games and to reduce the possible difference inbetween number of obtained medals by countries that played from first Olympic Games and countries that joined later. Figure 8 showing that through the years USA obtains the majority of the medals,other countries that takes the place in leader positions are Australia, China and Russia as for the rest analyzed countries dependancy between NOC and number of medals is not visible.
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:black "> __Correlation between Height and Weight__ </p>

<p style="font-family: times, serif; font-size:1pt; font-style:italic; color:black "> __H0 There is no correlation between height and weight.\n H1 There is correlation between height and weight of sportmen.__ </p>

<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> __Figure 9__ Correlation between height and weight of sportsmen.  </p>

```{r warning=FALSE, error=FALSE,message = FALSE , echo = FALSE}
ggplot(athlete_events_combined,aes(Height, Weight))+
  geom_point()+geom_smooth()
```
```{r}
cor.test(athlete_events_combined$Height,athlete_events_combined$Weight)
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Conclusion__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> Based on results of Pearson correlation test (p-value < 2.2e-16) there is strong positive correlation (cor 
0.7974128) between height and weight of sportsmen.</p>
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:black "> __H0 The gender does not effect the chance to get Gold in Tennis competition \n H1 Gender affects the ability of sportsmen to get Gold medal.__ </p>
```{r warning=FALSE}
athlete_tennis <- athlete_events_combined %>% filter(Sport == 'Tennis')
women_gold <- athlete_tennis %>% 
  filter(Sex == 'F', Medal == 'Gold') %>% 
  summarise(n())
women_all <- athlete_tennis %>% 
  filter(Sex == 'F') %>% 
  summarise(n())
men_gold <- athlete_tennis %>% 
  filter(Sex == 'M', Medal == 'Gold') %>% 
  summarise(n())
men_all <- athlete_tennis %>% 
  filter(Sex == 'M') %>% 
  summarise(n())
women_tennis <- women_gold[1,] / women_all[1,]
men_tennis <- men_gold[1,] / men_all[1,]
tennis_table = data.frame(women_tennis = women_tennis, men_tennis = men_tennis)
chisq.test(tennis_table)
```
<p style="font-family: times, serif; font-size:16pt; font-style:italic; color:DarkRed "> __Conclusion__ </p>
<p style="font-family: times, serif; font-size:14pt; font-style:italic; color:MidnightBlue"> The results of chi-squared tests (X-squared = 0.00031311, p-value = 0.9859) support the H0 hypotesis that gender does not affect the chance of sportsman to get Gold, which is logical as by now competition is divided into groups based on Sex.</p>

